Protocol
=====

Blackwing was designed to be an encapsulation protocol for Resource-Scarce devices, so that they can create an end-to-end encrypted tunnel when communicating. The protocol was designed to reduce the overhed generated by other known protocol, mainly due to key-exchange. The protocol is based on standard encryption algorithms such as RSA and AES-128/AES-256 (CFB or CBC) modes. Currently, most known MCUs provide libraries for such encryption algorithms.

.. _Mask:

Mask
------------

The first byte of a Blackwing message is the setup for everything that comes next. This byte is called the mask and provides the server with information regarding what to expect and how to behave. 

.. note::
  
   The mask is what defines the server behaviour. Therefore, pay attention to what you are setting. Most errors occur due to a bit mistake. 

.. _SecureMode:

Secure Mode
~~~~~~~~

Hello
  
.. _Stamp:

Stamp
------------

The Stamp provides the server with information regarding the microservice to foward the message, and the AES keys to use. 

.. note::

  The Stamp's size depends on the RSA key size chosen. For a 1024-bit, the minimum acceptable, the Stamp's size is 128 bytes. The size doubles as the key doubles in size.

.. note::

  The stamp must be msgpack serialized.
  
.. _Letter:

Letter
------------
